{
  "rules": {
    "sensitive-data-in-url": {
      "enabled": true,
      "severity": "high",
      "name": "Sensitive Data in URL",
      "description": "Detects sensitive information exposed in URL path or query parameters",
      "patterns": {
        "email": "[?&][^=]*=[^&]*[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}",
        "ssn": "\\b\\d{3}-\\d{2}-\\d{4}\\b",
        "credit_card": "\\b(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13}|6(?:011|5[0-9]{2})[0-9]{12})\\b",
        "api_key_param": "[?&](?:api[_-]?key|apikey|access[_-]?token|auth[_-]?token)=[^&]+",
        "bearer_token": "[?&][^=]*=Bearer[+%20]+[A-Za-z0-9\\-._~+/]+=*",
        "jwt_in_url": "[?&][^=]*=eyJ[A-Za-z0-9_-]*\\.[A-Za-z0-9_-]*\\.[A-Za-z0-9_-]*",
        "password_param": "[?&](?:password|passwd|pwd|secret)=[^&]+"
      }
    },
    "sensitive-headers": {
      "enabled": true,
      "severity": "high",
      "name": "Sensitive Data in Headers",
      "description": "Detects sensitive information in custom headers (non-standard authentication)",
      "headers": [
        "x-email",
        "x-user-email",
        "user-email",
        "x-password",
        "x-ssn",
        "x-credit-card",
        "x-phone",
        "x-dob",
        "date-of-birth"
      ]
    },
    "weak-authentication": {
      "enabled": true,
      "severity": "high",
      "name": "Weak Authentication",
      "description": "Detects weak or insecure authentication mechanisms",
      "checks": [
        {
          "type": "basic_auth_over_http",
          "pattern": "^Basic\\s+",
          "message": "Basic authentication over HTTP exposes credentials in Base64 (easily decoded)"
        },
        {
          "type": "api_key_in_query",
          "params": ["api_key", "apikey", "access_token", "auth_token"],
          "message": "API keys/tokens in query parameters are logged in server logs and browser history"
        }
      ]
    },
    "insecure-http": {
      "enabled": true,
      "severity": "critical",
      "name": "Insecure HTTP Protocol",
      "description": "Detects API calls using HTTP instead of HTTPS",
      "message": "API calls should use HTTPS to encrypt data in transit"
    },
    "missing-response-security-headers": {
      "enabled": true,
      "severity": "medium",
      "name": "Missing Response Security Headers",
      "description": "Checks for missing recommended security headers on responses",
      "headers": [
        "strict-transport-security",
        "x-content-type-options",
        "x-frame-options",
        "content-security-policy",
        "referrer-policy",
        "permissions-policy"
      ]
    },
    "cors-misconfiguration": {
      "enabled": true,
      "severity": "high",
      "name": "CORS Misconfiguration",
      "description": "Detects dangerous CORS policies that could allow credential theft",
      "checks": [
        {
          "type": "wildcard_with_credentials",
          "message": "CORS allows wildcard (*) origin with credentials - any site can steal user data"
        },
        {
          "type": "null_origin",
          "message": "CORS allows null origin - can be exploited via sandboxed iframes"
        },
        {
          "type": "origin_reflection",
          "message": "CORS reflects Origin header - vulnerable to any origin"
        }
      ]
    },
    "pii-in-request-body": {
      "enabled": false,
      "severity": "info",
      "name": "PII in Request Body",
      "description": "Detects Personally Identifiable Information in request payloads (disabled - expected in legitimate forms)",
      "fields": [
        "ssn",
        "social_security_number",
        "credit_card",
        "creditCard",
        "card_number",
        "cvv",
        "passport",
        "drivers_license",
        "bank_account",
        "routing_number"
      ]
    },
    "excessive-data-exposure": {
      "enabled": false,
      "severity": "low",
      "name": "Excessive Data Exposure",
      "description": "Detects endpoints that may return too much data (disabled - too noisy)",
      "checks": [
        {
          "type": "no_pagination",
          "message": "GET requests without pagination parameters may expose excessive data"
        }
      ]
    },
    "sql-injection-risk": {
      "enabled": true,
      "severity": "critical",
      "name": "SQL Injection Risk",
      "description": "Detects potential SQL injection vulnerabilities in parameters",
      "patterns": [
        "\\bSELECT\\b.*\\bFROM\\b",
        "\\bINSERT\\b.*\\bINTO\\b",
        "\\bUPDATE\\b.*\\bSET\\b",
        "\\bDELETE\\b.*\\bFROM\\b",
        "\\bDROP\\b.*\\bTABLE\\b",
        "\\bUNION\\b.*\\bSELECT\\b",
        "\\bOR\\b.*\\b1\\s*=\\s*1\\b",
        "'\\s*OR\\s*'1'\\s*=\\s*'1"
      ]
    },
    "xss-risk": {
      "enabled": true,
      "severity": "high",
      "name": "XSS Risk",
      "description": "Detects potential Cross-Site Scripting vulnerabilities",
      "patterns": [
        "<script[^>]*>",
        "javascript:",
        "onerror\\s*=",
        "onload\\s*=",
        "onclick\\s*=",
        "<iframe[^>]*>",
        "eval\\s*\\(",
        "document\\.cookie"
      ]
    },
    "path-traversal-risk": {
      "enabled": true,
      "severity": "high",
      "name": "Path Traversal Risk",
      "description": "Detects potential path traversal attacks",
      "patterns": [
        "\\.\\./",
        "\\.\\.\\\\",
        "%2e%2e/",
        "%2e%2e\\\\",
        "..%2f",
        "..%5c"
      ]
    },
    "insufficient-rate-limiting": {
      "enabled": false,
      "severity": "low",
      "name": "Insufficient Rate Limiting",
      "description": "Detects endpoints that may lack rate limiting (disabled - normal app behavior)",
      "threshold": 10,
      "timeWindow": 1000,
      "message": "Endpoint called multiple times rapidly without rate limit headers"
    },
    "weak-password-policy": {
      "enabled": true,
      "severity": "medium",
      "name": "Weak Password Policy",
      "description": "Detects weak password requirements in registration/change endpoints",
      "checks": [
        {
          "field": "password",
          "min_length": 8,
          "message": "Password should be at least 8 characters"
        }
      ]
    },
    "verbose-error-messages": {
      "enabled": true,
      "severity": "medium",
      "name": "Error Information Leakage",
      "description": "Detects stack traces or framework-specific error details in responses",
      "status_codes": [400, 401, 403, 404, 500, 502, 503],
      "patterns": [
        "Exception in thread",
        "Stack trace:",
        "Traceback (most recent call last):",
        "org\\.springframework\\.",
        "java\\.lang\\.",
        "System\\.NullReferenceException",
        "ReferenceError:",
        "TypeError:",
        "SQLSTATE",
        "SequelizeDatabaseError",
        "at [^\n]+\\(.*:\\d+:\\d+\\)",
        "warning:.*deprecated"
      ],
      "message": "Response appears to expose internal error details"
    },
    "predictable-resource-ids": {
      "enabled": false,
      "severity": "low",
      "name": "Predictable Resource IDs",
      "description": "Detects sequential numeric IDs that could be enumerated (disabled - requires proper authz regardless)",
      "pattern": "\\b\\d{1,8}\\b",
      "message": "Sequential numeric IDs can be enumerated; consider using UUIDs"
    },
    "missing-authentication": {
      "enabled": false,
      "severity": "medium",
      "name": "Missing Authentication",
      "description": "Detects API calls without authentication headers (disabled by default - too noisy for SPAs)",
      "excludePaths": ["/login", "/register", "/health", "/status", "/public", "/api/v", "/docs", "/swagger", "/favicon", "/static", "/assets", "/.well-known", "/manifest", "/robots"],
      "excludeMethods": ["OPTIONS", "HEAD"],
      "message": "API endpoint accessed without authentication headers"
    },
    "outdated-tls": {
      "enabled": false,
      "severity": "high",
      "name": "Outdated TLS Version",
      "description": "Detects usage of outdated TLS versions (Note: Limited detection in browser)",
      "message": "Ensure API uses TLS 1.2 or higher"
    },
    "mass-assignment": {
      "enabled": true,
      "severity": "high",
      "name": "Mass Assignment Risk",
      "description": "Detects potential mass assignment vulnerabilities",
      "sensitiveFields": [
        "isAdmin",
        "is_admin",
        "role",
        "roles",
        "permissions",
        "verified",
        "is_verified",
        "approved",
        "is_approved",
        "balance",
        "credits"
      ],
      "message": "Sensitive fields in request may allow privilege escalation"
    },
    "unencrypted-sensitive-data": {
      "enabled": true,
      "severity": "critical",
      "name": "Unencrypted Sensitive Data",
      "description": "Detects unencrypted transmission of sensitive data",
      "fields": [
        "password",
        "secret",
        "private_key",
        "privateKey",
        "pin",
        "cvv",
        "security_code"
      ],
      "message": "Sensitive data transmitted without encryption"
    },
    "insecure-cookies": {
      "enabled": true,
      "severity": "high",
      "name": "Insecure Cookies",
      "description": "Detects Set-Cookie attributes missing security flags",
      "message": "Cookies should set Secure, HttpOnly and SameSite attributes"
    },
    "pii-in-response-body": {
      "enabled": true,
      "severity": "critical",
      "name": "Sensitive Data in Response Body",
      "description": "Detects unmasked sensitive data patterns in response payloads",
      "patterns": {
        "ssn": "\\b\\d{3}-\\d{2}-\\d{4}\\b",
        "full_credit_card": "\\b\\d{4}[\\s-]?\\d{4}[\\s-]?\\d{4}[\\s-]?\\d{4}\\b",
        "private_key": "-----BEGIN (RSA |EC )?PRIVATE KEY-----"
      }
    },
    "missing-input-validation": {
      "enabled": false,
      "severity": "high",
      "name": "Missing Input Validation",
      "description": "Detects potentially dangerous user input without validation indicators",
      "message": "User input may lack server-side validation"
    },
    "hardcoded-secrets": {
      "enabled": true,
      "severity": "critical",
      "name": "Hardcoded Secrets in Request",
      "description": "Detects hardcoded secrets, API keys, or tokens",
      "patterns": {
        "aws_key": "(A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}",
        "github_token": "ghp_[A-Za-z0-9]{36}",
        "slack_token": "xox[baprs]-[0-9]{10,12}-[0-9]{10,12}-[A-Za-z0-9]{24,32}",
        "generic_api_key": "['\"][a-zA-Z0-9]{32,}['\"]"
      }
    },
    "open-redirect": {
      "enabled": true,
      "severity": "high",
      "name": "Open Redirect Risk",
      "description": "Detects URL parameters that could enable open redirects",
      "params": ["redirect", "url", "next", "return", "returnUrl", "goto", "continue"]
    },
    "ssrf-risk": {
      "enabled": true,
      "severity": "high",
      "name": "SSRF Risk",
      "description": "Detects parameters that could enable Server-Side Request Forgery",
      "params": ["url", "uri", "endpoint", "callback", "webhook", "fetch", "proxy"]
    },
    "debug-endpoints": {
      "enabled": true,
      "severity": "medium",
      "name": "Debug/Admin Endpoints Exposed",
      "description": "Detects potentially sensitive debug or admin endpoints in production",
      "patterns": [
        "/debug",
        "/_debug",
        "/actuator/",
        "/actuator/env",
        "/actuator/heapdump",
        "/actuator/threaddump",
        "/phpinfo",
        "/.env",
        "/.git",
        "/.svn",
        "/config.json",
        "/config.yml",
        "/trace",
        "/metrics",
        "/dump",
        "/elmah.axd",
        "/server-status",
        "/server-info",
        "/__debug__"
      ]
    },
    "untrusted-client-identity": {
      "enabled": true,
      "severity": "critical",
      "name": "IDOR - Client-Supplied Identity (CWE-639)",
      "description": "Detects identity fields in request body when JWT is present - server should extract identity from token, not trust client input",
      "identityFields": [
        "userId",
        "user_id",
        "userid",
        "accountId",
        "account_id",
        "customerId",
        "customer_id",
        "ownerId",
        "owner_id",
        "memberId",
        "member_id"
      ],
      "excludeEndpoints": [
        "/login",
        "/register",
        "/signup",
        "/auth",
        "/forgot-password",
        "/reset-password",
        "/verify",
        "/invite",
        "/share",
        "/transfer",
        "/admin"
      ],
      "message": "IDOR Risk: User ID in request body with JWT auth - attacker can modify to access other users' data"
    },
    "idor-in-path": {
      "enabled": true,
      "severity": "high",
      "name": "IDOR - Sequential ID in Path (CWE-639)",
      "description": "Detects sequential numeric IDs in URL paths that could be enumerated for unauthorized access",
      "pathPatterns": [
        "/users/\\d+",
        "/accounts/\\d+",
        "/orders/\\d+",
        "/invoices/\\d+",
        "/documents/\\d+",
        "/files/\\d+",
        "/messages/\\d+",
        "/transactions/\\d+"
      ],
      "message": "Sequential ID in path - verify server enforces authorization (IDOR vulnerability if not)"
    },
    "jwt-security": {
      "enabled": true,
      "severity": "critical",
      "name": "JWT Security Issues",
      "description": "Detects JWT tokens with security weaknesses",
      "checks": [
        {
          "type": "none_algorithm",
          "message": "JWT uses 'none' algorithm - signature not verified!"
        },
        {
          "type": "missing_expiry",
          "message": "JWT has no expiration claim - tokens valid forever"
        },
        {
          "type": "long_expiry",
          "maxHours": 168,
          "message": "JWT expiration is too long (>7 days)"
        }
      ]
    },
    "http-method-override": {
      "enabled": true,
      "severity": "medium",
      "name": "HTTP Method Override",
      "description": "Detects method override headers that could bypass security controls",
      "headers": [
        "X-HTTP-Method-Override",
        "X-HTTP-Method",
        "X-Method-Override"
      ],
      "message": "HTTP method override header detected - could bypass method-based access controls"
    },
    "server-version-disclosure": {
      "enabled": true,
      "severity": "low",
      "name": "Server Version Disclosure",
      "description": "Detects server/framework version information in response headers",
      "headers": [
        "Server",
        "X-Powered-By",
        "X-AspNet-Version",
        "X-AspNetMvc-Version",
        "X-Runtime"
      ],
      "message": "Server version disclosed - helps attackers identify vulnerable components"
    },
    "command-injection-risk": {
      "enabled": true,
      "severity": "critical",
      "name": "Command Injection Risk",
      "description": "Detects potential command injection patterns in parameters",
      "patterns": [
        ";\\s*(?:ls|cat|whoami|id|pwd|uname)",
        "\\|\\s*(?:ls|cat|whoami|id|pwd|uname)",
        "\\$\\([^)]+\\)",
        "`[^`]+`",
        "&&\\s*(?:ls|cat|whoami|id|pwd)",
        "\\|\\|\\s*(?:ls|cat|whoami)"
      ],
      "message": "Potential command injection pattern detected"
    },
    "xxe-risk": {
      "enabled": true,
      "severity": "critical",
      "name": "XXE Risk",
      "description": "Detects XML with external entity declarations",
      "contentTypes": ["application/xml", "text/xml"],
      "patterns": [
        "<!ENTITY",
        "<!DOCTYPE[^>]*\\[",
        "SYSTEM\\s+['\"](?:file|http|ftp):"
      ],
      "message": "XML with external entity reference - potential XXE vulnerability"
    },
    "broken-access-control": {
      "enabled": true,
      "severity": "info",
      "name": "Access Control Test Pattern Detected",
      "description": "Detects requests that might indicate access control testing (informational)",
      "patterns": {
        "admin_in_request": "[?&](admin|isAdmin|is_admin|role)=(true|1|admin)",
        "privilege_escalation": "[?&](role|privilege|permission)=",
        "force_browsing": "/admin/|/internal/|/private/|/management/"
      },
      "message": "Request pattern suggests access control testing - verify server enforces authz"
    },
    "crlf-injection": {
      "enabled": true,
      "severity": "high",
      "name": "CRLF Injection Risk",
      "description": "Detects CRLF sequences that could enable header injection",
      "patterns": [
        "%0d%0a",
        "%0D%0A",
        "\\r\\n",
        "%E5%98%8A%E5%98%8D"
      ],
      "message": "CRLF sequence in request - potential header injection"
    },
    "sensitive-file-exposure": {
      "enabled": true,
      "severity": "critical",
      "name": "Sensitive File Exposure",
      "description": "Detects access to sensitive configuration or backup files",
      "patterns": [
        "\\.bak$",
        "\\.backup$",
        "\\.old$",
        "\\.sql$",
        "\\.log$",
        "web\\.config",
        "wp-config\\.php",
        "\\.htaccess",
        "\\.htpasswd",
        "id_rsa",
        "\\.pem$",
        "\\.key$"
      ],
      "message": "Access to potentially sensitive file detected"
    },
    "authorization-header-exposure": {
      "enabled": true,
      "severity": "info",
      "name": "Authorization Header Captured",
      "description": "Authorization headers are being captured - informational for auditing",
      "message": "Authorization token captured - verify server does not log auth headers for compliance"
    },
    "ssti-risk": {
      "enabled": true,
      "severity": "critical",
      "name": "Server-Side Template Injection Risk",
      "description": "Detects template expression patterns that could enable SSTI attacks",
      "patterns": [
        "\\{\\{.*\\}\\}",
        "\\$\\{.*\\}",
        "<%.*%>",
        "#\\{.*\\}",
        "\\{%.*%\\}",
        "@\\(.*\\)"
      ],
      "message": "Template expression in request - potential SSTI vulnerability"
    },
    "insecure-deserialization": {
      "enabled": true,
      "severity": "critical",
      "name": "Insecure Deserialization Risk",
      "description": "Detects serialized object patterns that could enable RCE",
      "patterns": {
        "java_serialized": "rO0AB",
        "php_serialized": "^[OaCsiNdb]:\\d+:",
        "python_pickle": "\\x80\\x03|\\x80\\x04",
        "dotnet_viewstate": "__VIEWSTATE"
      },
      "message": "Serialized object detected - verify deserialization is safe"
    },
    "host-header-injection": {
      "enabled": true,
      "severity": "high",
      "name": "Host Header Injection Risk",
      "description": "Detects suspicious host header values that could enable cache poisoning or password reset poisoning",
      "suspiciousPatterns": [
        "localhost",
        "127\\.0\\.0\\.1",
        "internal",
        "\\.\\.\\.",
        "@"
      ],
      "message": "Suspicious host header value - potential host header injection"
    },
    "graphql-introspection": {
      "enabled": true,
      "severity": "medium",
      "name": "GraphQL Introspection Exposed",
      "description": "Detects GraphQL introspection queries that expose API schema",
      "patterns": [
        "__schema",
        "__type",
        "introspectionQuery"
      ],
      "message": "GraphQL introspection query detected - should be disabled in production"
    },
    "api-version-bypass": {
      "enabled": true,
      "severity": "medium",
      "name": "API Version Bypass Attempt",
      "description": "Detects requests to deprecated or alternative API versions",
      "patterns": [
        "/v1/",
        "/api/v0/",
        "/api/v1/",
        "/api/old/",
        "/api/legacy/",
        "/api/deprecated/"
      ],
      "message": "Request to alternative API version - older versions may lack security controls"
    },
    "race-condition-risk": {
      "enabled": true,
      "severity": "high",
      "name": "Race Condition Risk",
      "description": "Detects state-changing endpoints vulnerable to race conditions",
      "sensitiveEndpoints": [
        "/transfer",
        "/withdraw",
        "/redeem",
        "/coupon",
        "/voucher",
        "/vote",
        "/like",
        "/purchase",
        "/checkout",
        "/payment"
      ],
      "methods": ["POST", "PUT", "PATCH"],
      "message": "State-changing endpoint - test for race condition vulnerabilities"
    },
    "ldap-injection-risk": {
      "enabled": true,
      "severity": "critical",
      "name": "LDAP Injection Risk",
      "description": "Detects potential LDAP injection patterns in parameters",
      "patterns": [
        "\\*\\)",
        "\\(\\|",
        "\\(&",
        "\\)\\(",
        "\\)\\(|",
        "admin\\)\\(&\\)",
        "\\)\\)\\(\\("
      ],
      "message": "Potential LDAP injection pattern detected"
    },
    "nosql-injection-risk": {
      "enabled": true,
      "severity": "critical",
      "name": "NoSQL Injection Risk",
      "description": "Detects potential NoSQL injection patterns",
      "patterns": [
        "\\$where",
        "\\$gt",
        "\\$lt",
        "\\$ne",
        "\\$regex",
        "\\$or\\s*:",
        "\\$and\\s*:",
        "mapReduce",
        "\\{\\s*\\$"
      ],
      "message": "Potential NoSQL injection pattern detected"
    },
    "sensitive-param-names": {
      "enabled": true,
      "severity": "medium",
      "name": "Sensitive Parameter Detected",
      "description": "Detects parameter names that often contain sensitive data",
      "params": [
        "token",
        "secret",
        "key",
        "password",
        "pwd",
        "auth",
        "credential",
        "private",
        "session"
      ],
      "message": "Sensitive parameter name detected - ensure value is properly protected"
    }
  },
  "metadata": {
    "version": "1.0.0",
    "lastUpdated": "2025-10-18",
    "description": "Customizable security vulnerability detection rules for GAMX Chrome & Edge Extension"
  }
}
